# 1 Quick Start

[How to run python script in spyder](https://github.com/ring630/Material_Characterization/blob/main/docs/HOW_TO_RUN_PYAEDT_IN_SPYDER.md)

Apart from PyAEDT, please execute below command to install required packages

$ pip install networkx

# Introduction

This project is built on top of
[PyAEDT](https://github.com/pyansys/PyAEDT). DCIR_Automation is licenced under
the [MIT License](https://github.com/pyansys/PyAEDT/blob/main/LICENSE).

This script demonstrates an automated workflow to extract and visualize power tree. The input file can be either EDB or
tel netlist. There are two classes

1, class PowerTree takes EDB as input

2, class PowerTreeSchematic takes tel netlist as input.

## PowerTreeTel exmaple

````python
from utils.power_tree_schematic import PowerTreeTel
from utils.power_rail import PowerRail
````

Define test point refdes naming convention

````
PowerTreeTel.TP_PRIFIX = ["TP", "INC"]
````

Define fuse refdes naming convention. All fuses will be replaced by a resistor

````
PowerTreeTel.REPLACE_BY_RES = ["F"]ยง
````

Define connector refdes naming convention

````
PowerTreeTel.CONNECTOR_PRIFIX = ["X", "J"]
````

Define ground net name

````
PowerTreeTel.GROUND = ["GND"]
````

Exclude components by refdes explicitly

````
PowerTreeTel.COMP_EXCLUDE_LIST = []
````

Exclude component pin explicitly

````
PowerTreeTel.COMP_PIN_EXCLUDE_LIST = ["U2A5.E1"]
````

Whether to exlucde connector from power tree

````
PowerTreeTel.EXCLUE_CONNECTOR = True
````
Example on Galileo board
````
targetfile = r"galileo_example\galileo.tel"
print(targetfile)
PowerTreeTel(
    fpath=targetfile,
    bom="galileo_exmaple/bom_galileo.csv",
    power_rail_list=[
        PowerRail(
            prim_refdes_pin="U3A1.37", voltage=1.0,
            sec_refdes_pin_list=[],
            sink_power_info="galileo_example/U3A1-BST_V1P0_S0.csv"),

        PowerRail(prim_refdes_pin="U3A1.14", voltage=3.3),
    ],
    nexxim_sch=True
)
````
Power tree is saved in ``temp`` folder as png files. The power tree is generated by networkx algorithm. If the placement
is not optimal, just re-run the script.
<img width="829" alt="image" src="https://user-images.githubusercontent.com/27995305/181276100-d0c05b6b-956f-455b-adcc-3a120400f062.png">

Extracted sinks are saved in csv file in ``temp`` folder.

<img width="239" alt="image" src="https://user-images.githubusercontent.com/27995305/181278226-f43a7bd6-934e-4fc8-8bde-cd40fd079dc2.png">

The same power tree is created in Nexxim for DC analysis.

<img width="917" alt="image" src="https://user-images.githubusercontent.com/27995305/181278392-a13c45a2-0363-46b8-b480-00136f8573b8.png">

